# ğŸ–¥ï¸ CGCNN-tutorial
CGCNNì€ Jeffrey C. Grossman êµìˆ˜ë‹˜ê³¼ Tian Xie ë°•ì‚¬ë‹˜ì´ ê°œë°œí•œ ì†Œì¬ ë¬¼ì„± ì˜ˆì¸¡ìš© ê·¸ë˜í”„ ì‹ ê²½ë§ ë„¤íŠ¸ì›Œí¬ ëª¨ë¸ë¡œ, ë‹¤ìŒ ë…¼ë¬¸ì— ìì„¸íˆ ì„¤ëª…ë˜ì–´ ìˆë‹¤.

<https://doi.org/10.1103/PhysRevLett.120.145301>

ì´ ë…¼ë¬¸ì—ì„œ ë‹¤ë£¨ê³  ìˆëŠ” ëª¨ë¸ì˜ ì‹¤ìŠµ ì½”ë“œëŠ” <https://github.com/txie-93/cgcnn?tab=readme-ov-file>ì—ì„œ ë‹¤ìš´ë°›ì„ ìˆ˜ ìˆë‹¤.

í•˜ì§€ë§Œ ìœ„ githubì˜ ë°ì´í„°ì…‹ì€ í¬ê¸°ê°€ ë§¤ìš° ì‘ì•„ ì‹¤ìŠµì„ ì§„í–‰í•˜ëŠ” ë° ë¶€ì¡±í•¨ì´ ìˆê¸°ì—, KIST ê¹€ë™í›ˆ ë°•ì‚¬ë‹˜ì´ ê¸°ì¡´ github ë°ì´í„°ì…‹ì— ìƒˆë¡œìš´ datasetê³¼ ë³´ì¡°ê¸°ëŠ¥ ì½”ë“œë¥¼ ì¶”ê°€í•œ google colab ìë£Œë¥¼ ì œê³µí•˜ê³  ìˆë‹¤. 

<https://drive.google.com/drive/folders/1HbxgZYCAJWynwFCwgWxfeg4-SrlWs0Gm>

ì´ íŠœí† ë¦¬ì–¼ì€ ìƒë‹¨ì˜ datasetì„ ê°€ì§€ê³  ì§„í–‰í•œ CGCNN ì‹¤ìŠµì„ step-by-stepìœ¼ë¡œ ë‚˜íƒ€ë‚¸ ê²ƒì´ë‹¤.
ì œê³µí•˜ëŠ” ë°ì´í„°ë¥¼ ì „ë¶€ ë‹¤ìš´ë¡œë“œ í›„, ì••ì¶• í•´ì œí•˜ë©´ ëœë‹¤. 




## ğŸ“Œ í”„ë¡œê·¸ë¨ ì„¤ì¹˜ ë° í™˜ê²½ì„¤ì •
**CGCNN ì‹¤ìŠµì„ ìœ„í•´ì„œëŠ” ìš°ë¦¬ê°€ ë§Œë“¤ì–´ ë†“ì€ ê°€ìƒí™˜ê²½ ì•ˆì— PyTorch, scikit-learn, pymatgenì´ë¼ëŠ” ì„¸ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•´ì¤˜ì•¼ í•œë‹¤.
ìš°ì„  conda ìì²´ë¥¼ ìµœì‹  ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•˜ê³ , ê°€ìƒí™˜ê²½ì„ ë§Œë“¤ì–´ì¤€ ë’¤ ê·¸ ì•ˆì— íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•  ê²ƒì´ë‹¤.**


### **1. conda ì—…ë°ì´íŠ¸**

condaê°€ ìµœì‹ ë²„ì „ì´ ì•„ë‹ˆë¼ë©´, íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì‹œ ì—ëŸ¬ê°€ ëœ° ìˆ˜ë„ ìˆë‹¤.
anaconda prompt í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰ì‹œì¼œì¤€ í›„, ë‹¤ìŒì²˜ëŸ¼ ì…ë ¥í•˜ì—¬ condaë¥¼ ìµœì‹  ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸ ì‹œì¼œì¤€ë‹¤.
~~~
conda update -n base -c defaults conda
~~~
ë§Œì¼ ì—…ë°ì´íŠ¸ë¥¼ í–ˆìŒì—ë„ ìê¾¸ 
~~~
WARNING: A newer version of conda exists.
current version: 25.5.1
latest version: 25.7.0
~~~
ì²˜ëŸ¼ ëœ¬ë‹¤ë©´, 
~~~
conda update conda --all
~~~
ì„ ì…ë ¥í•˜ì—¬ í•´ê²°í•  ìˆ˜ ìˆë‹¤.


ì œëŒ€ë¡œ ì—…ë°ì´íŠ¸ ë˜ì—ˆëŠ”ì§€ëŠ”
~~~
conda --version
~~~
ì„ ì…ë ¥í–ˆì„ ë•Œ ìµœì‹  ë²„ì „ìœ¼ë¡œ ëœ¨ëŠ”ì§€ í™•ì¸í•˜ë©´ ëœë‹¤.


### **2. ê°€ìƒí™˜ê²½ ìƒì„± í›„ ê·¸ ì•ˆì— íŒ¨í‚¤ì§€ ì„¤ì¹˜**

conda ì „ì²´ê°€ ì•„ë‹ˆë¼ ì‹¤ìŠµì„ ì§„í–‰í•  í™˜ê²½ì—ë§Œ PyTorch, scikit-learn, pymatgenë¥¼ ì„¤ì¹˜í•˜ê¸° ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì´ ìƒˆë¡œìš´ ê°€ìƒ í™˜ê²½ì„ ë§Œë“¤ì–´ì¤€ë‹¤. 

í™˜ê²½ ì´ë¦„ì€ ì›í•˜ëŠ” ëŒ€ë¡œ ì§€ì–´ì£¼ë©´ ëœë‹¤. ì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” 'cgcnn'ì´ë¼ëŠ” ì´ë¦„ì„ ë¶™ì¸ ê°€ìƒí™˜ê²½ì„ ë§Œë“¤ ê²ƒì´ë‹¤.
~~~
conda create -n cgcnn
~~~
ê¸°ë³¸í™˜ê²½ì¸ (base) ëŒ€ì‹  ìƒˆë¡œ ìƒì„±ëœ (cgcnn)ì´ë¼ëŠ” ê°€ìƒ í™˜ê²½ì„ í™œì„±í™” ì‹œì¼œì¤€ í›„,
~~~
conda activate cgcnn
~~~

ë‹¤ìŒê³¼ ê°™ì´ ì„¸ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•´ì¤€ë‹¤.
ì´ë•Œ, pipì€ íŒŒì´ì¬ìœ¼ë¡œ ì‘ì„±ëœ íŒ¨í‚¤ì§€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•˜ê³  ê´€ë¦¬í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´ì´ë‹¤.
~~~
# PyTorch ì„¤ì¹˜
pip install torch

# scikit-learn ì„¤ì¹˜
pip install scikit-learn

# Pymatgen ì„¤ì¹˜
pip install pymatgen
~~~
`pip list`ë¥¼ ì…ë ¥í–ˆì„ ë•Œ, ë¦¬ìŠ¤íŠ¸ì— ì„¸ íŒ¨í‚¤ì§€ê°€ í¬í•¨ë˜ì–´ ìˆë‹¤ë©´ ì„±ê³µì ìœ¼ë¡œ ì„¤ì¹˜ëœ ì´ë‹¤.

ì´ì œ êµ¬ê¸€ ë“œë¼ì´ë¸Œì—ì„œ ë‹¤ìš´ë°›ì•˜ë˜ íŒŒì¼ì´ ìˆëŠ” ê²½ë¡œë¡œ ì´ë™í•´ì¤˜ì•¼ í•œë‹¤.
ì»´í“¨í„° ìƒì—ì„œ êµ¬ê¸€ ë“œë¼ì´ë¸Œ í´ë”ë¥¼ ìš°í´ë¦­ í•˜ê³  ì†ì„±ì— ë“¤ì–´ê°€ë©´, ë‹¤ìŒê³¼ ê°™ì´ íŒŒì¼ ê²½ë¡œê°€ ë‚˜ì˜¨ë‹¤.

~~~
C:\Users\ingyeong\Desktop\Summer
~~~

conda ë‚´ì—ì„œ ì´ íŒŒì¼ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ promptì— ë‹¤ìŒê³¼ ê°™ì´ ê²½ë¡œë¥¼ ì…ë ¥í•´ì¤€ë‹¤.
~~~
cd Desktop/Summer/cgcnn-master
~~~

ë‹¤ìš´ë°›ì•˜ë˜ íŒŒì¼ì´ ìˆëŠ” ê²½ë¡œì— ë“¤ì–´ê°„ í›„, ê·¸ í´ë” ì•ˆì— ìˆë˜ ì½”ë“œì¸ main.pyë¥¼ ì‹œí—˜ì‚¼ì•„ ì‹¤í–‰ì‹œì¼œ ë´¤ì„ ë•Œ 
~~~
python main.py -h
~~~
ë‹¤ìŒê³¼ ê°™ì´ option ëª©ë¡ì´ ì­‰ ëœ¬ë‹¤ë©´ ì‹¤ìŠµì„ ìœ„í•œ í™˜ê²½ì„¤ì •ì´ ëë‚œ ê²ƒì´ë‹¤.
~~~
usage: main.py [-h] [--task {regression, classification}]
.
.
~~~

## ğŸ“Œ ì½”ë“œ Framework

íŒŒì¼ì€ ì„œë¡œ ë‹¤ìŒê³¼ ê°™ì€ ê´€ê³„ë¥¼ ê°€ì§€ë©° ì‘ë™í•œë‹¤. ê° íŒŒì¼ì— ëŒ€í•œ ìƒì„¸í•œ ì„¤ëª…ì€ í•˜ë‹¨ì— ê¸°ìˆ í•˜ì˜€ë‹¤. 

  ![ê·¸ë¦¼1](https://github.com/user-attachments/assets/6919bb6d-28dc-47a7-9d87-fb076392c278)



1) input íŒŒì¼ ë° í•˜ì´í¼íŒŒë¼ë¯¸í„° ì„¤ì •
2) `main.py` ì‹¤í–‰ì‹œí‚¤ë©´ `id_prop.csv`ë¥¼ ì½ì–´ ì²« ë²ˆì§¸ ì—´ì¸ idì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ì–»ê²Œ ë¨.
3) `data.py`ë¥¼ í˜¸ì¶œí•˜ì—¬ `main.py`ì—ì„œ ì½ì–´ë‚¸ id ë¦¬ìŠ¤íŠ¸ê°€ `data.py`ë¡œ ë„˜ì–´ê°. `data.py`ëŠ” ë°›ì€ id ë¦¬ìŠ¤íŠ¸ì— í•´ë‹¹í•˜ëŠ” `id.cif` íŒŒì¼ì„ ì°¾ìŒ.
4) `id.cif`ì—ì„œ ì–»ì€ ê²°ì •êµ¬ì¡°ëŠ” `atom_init.json` íŒŒì¼ì„ ë°”íƒ•ìœ¼ë¡œ ë²¡í„°í™”ëœ ê·¸ë˜í”„ í˜•íƒœë¡œ ë‚˜íƒ€ë‚´ì§.
5) `data.py`ì—ì„œ ë²¡í„°í™”ëœ ê·¸ë˜í”„ëŠ” ë‹¤ì‹œ `main.py`ë¡œ ë°˜í™˜ë¨. ì´í›„ `id_prop.csv`ì— ë”°ë¼ ê²°ì •êµ¬ì¡°ì™€ ë¬¼ì„±ì´ ë§¤ì¹­ë¨.
6) `main.py`ëŠ” í•˜ì´í¼íŒŒë¼ë¯¸í„°ì™€ ë²¡í„°í™”ëœ ê·¸ë˜í”„ ë°ì´í„°ë¥¼ `model.py`ë¡œ ì „ì†¡.
7) `model.py`ëŠ” CGCNN ëª¨ë¸ì˜ êµ¬ì¡°ë¥¼ ì •ì˜í•œ í›„ì— ë‹¤ì‹œ `main.py`ë¡œ ë°˜í™˜.
8) `main.py`ì—ì„œ ì •í•´ì§„ epoch íšŸìˆ˜ë§Œí¼ í•™ìŠµ ì§„í–‰ í›„, ê²°ê³¼ ë°ì´í„° ìƒì„±.

------------------------

### ğŸ”· input íŒŒì¼

Trainingê³¼ Predictingì„ ìœ„í•´ì„œëŠ” ìš°ì„  í•„ìš”í•œ ë°ì´í„°ë“¤ì„ í•˜ë‚˜ì˜ í´ë”ë¡œ ë¬¶ì–´ì•¼ í•œë‹¤. (customized dataset)
ëª¨ë¸ì— inputìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” customized datasetì—ëŠ” ë‹¤ìŒ íŒŒì¼ë“¤ì´ í¬í•¨ë˜ì–´ì•¼ í•œë‹¤.

- `id_prop.csv` : idì™€ propertyë¥¼ ë¬¶ì€ csv íŒŒì¼ë¡œ 1ì—´ì—ëŠ” id, 2ì—´ì—ëŠ” propertyê°€ ì í˜€ìˆë‹¤.
  
    `id`ë€ ê° ê²°ì • êµ¬ì¡°ë¥¼ êµ¬ë¶„í•˜ëŠ” ì‹ë³„ìë¡œ, ê° ê²°ì •êµ¬ì¡°ì— ë²ˆí˜¸ë¥¼ ë¶€ì—¬í•´ì¤€ ê²ƒì´ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤.

   Materials Project ì—ì„œëŠ” ê° ê²°ì •êµ¬ì¡°ë¥¼ ê³ ìœ í•œ ìˆ«ìì¸ 'id'ë¡œ ê´€ë¦¬í•œë‹¤. (ex. cubic êµ¬ì¡°ì˜ SiO2 idëŠ” 8352)
  
    `property`ë€ í•™ìŠµí•˜ë ¤ëŠ” ë¬¼ì„±ê°’(ex. bandgap, formation energy)ì„ ì˜ë¯¸í•œë‹¤.

  í•™ìŠµí•  ë•ŒëŠ” 2ì—´ì˜ ë¬¼ì„±ê°’ì´ ì •ë‹µìœ¼ë¡œ ì“°ì´ì§€ë§Œ, ì˜ˆì¸¡í•  ë•ŒëŠ” ì •ë‹µ ê°’ì´ í•„ìš” ì—†ë‹¤.

  í•˜ì§€ë§Œ 2ì—´ì„ ë¹„ì›Œë‘˜ ì‹œ ì½”ë“œê°€ íŒŒì¼ì„ ì œëŒ€ë¡œ ì½ì§€ ëª»í•˜ë¯€ë¡œ, ì•„ë¬´ ìˆ«ìë¼ë„ ë„£ì–´ì„œ í˜•ì‹ì„ ë§ì¶°ì£¼ì–´ì•¼ í•œë‹¤.

- `id.cif` : ê²°ì •êµ¬ì¡°ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” íŒŒì¼ë¡œ, ê²°ì •ì˜ ë¬¼ë¦¬ì  íŠ¹ì„±, ì¢Œí‘œ, ê²©ì ë“±ì— ê´€í•œ ì •ë³´ë¥¼ ì•Œë ¤ì¤€ë‹¤.

   MPì—ì„œ ì œê³µí•˜ëŠ” ê²°ì •êµ¬ì¡° íŒŒì¼ì€ 'mp-id.cif' í˜•íƒœë¡œ ì œê³µëœë‹¤. (ex. mp-13, mp-241)

   ë‹¨ì§€ ìš°ë¦¬ê°€ inputìœ¼ë¡œ í™œìš©í•˜ëŠ” ë°ì´í„°ì¸ 'id_prop.csv'ì˜ ì²« ì—´ê³¼ cifì˜ íŒŒì¼ëª…ì„ ì¼ì¹˜ì‹œí‚¤ê¸° ìœ„í•´ 'id.cif'ë¡œ ë°”ê¿”ì„œ ì €ì¥í•˜ëŠ” ê²ƒì´ë‹¤.
  
- `atom_init.json` : ì›ì†Œë¥¼ ìˆ«ìë¡œ í‘œí˜„í•˜ê¸° ìœ„í•œ ì´ˆê¸° ë²¡í„° ë°ì´í„°ë¡œ, ì£¼ê¸°ìœ¨í‘œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê° ì›ì†Œì— ëŒ€í•œ íŠ¹ì„±ì´ one-hot encoding ëœ í˜•íƒœë¡œ ì •ë¦¬ë˜ì–´ ìˆë‹¤.

  ì‰½ê²Œ ë§í•´ SiëŠ” ë²¡í„°ë¡œ [ìˆ«ì, , , ..], NaëŠ” ë²¡í„°ë¡œ [ìˆ«ì, , , ..]ì™€ ê°™ì´ ë³€í™˜í•˜ë¼ê³  ì•Œë ¤ì£¼ëŠ” ì°¸ê³ ìš© ë¬¸ì„œì´ë‹¤.
  

### ğŸ”· ëª¨ë¸ ë™ì‘ íŒŒì¼

.py íŒŒì¼ì€ ì‰½ê²Œ ë§í•´ ë ˆì‹œí”¼ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤. ìš°ë¦¬ê°€ ë ˆì‹œí”¼ë¥¼ ë³´ê³  ìš”ë¦¬í•˜ë“¯ì´, .py íŒŒì¼ì„ ì‹¤í–‰ì‹œí‚´ìœ¼ë¡œì¨ ëª¨ë¸ì´ ì‘ë™í•  ìˆ˜ ìˆëŠ” ì½”ë“œë¥¼ ë™ì‘ì‹œí‚¤ëŠ” ê²ƒì´ë‹¤.

- `main.py` : CGCNNì˜ í•µì‹¬ ì›ë¦¬ê°€ êµ¬í˜„ë˜ëŠ” ì½”ë“œë¡œ, MPë¡œë¶€í„° ê²°ì •êµ¬ì¡°(id)ë¥¼ inputìœ¼ë¡œ ë°›ì•„ ë¬¼ì„±(property)ì„ outputìœ¼ë¡œ ë‚´ë†“ëŠ”ë‹¤.

  ì°¸ê³ ) ê¸°íƒ€ í•˜ì´í¼íŒŒë¼ë¯¸í„°ë„ `main.py -h`ë¥¼ ì…ë ¥í•˜ë©´ ì¡°ì ˆí•  ìˆ˜ ìˆë‹¤.
  
- `data.py` : idë¥¼ inputìœ¼ë¡œ ë°›ì•„ ë²¡í„°í™”ëœ ê·¸ë˜í”„ë¥¼ outputìœ¼ë¡œ ë‚´ë†“ëŠ”ë‹¤.
  
  ì…ë ¥ë°›ì€ idì— í•´ë‹¹í•˜ëŠ” ê²°ì •êµ¬ì¡°(.cif)ë¥¼ ë°›ì•„ì˜¤ëŠ” ì§€ì ê³¼, ê²°ì •êµ¬ì¡°ë¥¼ ë³´ê³  ë²¡í„°í™”ì‹œí‚¤ëŠ” ì§€ì (atom_init.json) ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.
  
  ì°¸ê³ ) data.py ì½”ë“œ ì¤‘ 300ë²ˆì§¸ ì¤„ì˜ ê°’ë“¤(radius,dmin, ..)ì„ ì¡°ì ˆí•˜ë©´ edge vector ì¡°ì ˆì´ ê°€ëŠ¥í•˜ë‹¤. (Gaussian distancing í˜•íƒœì˜ edge vector)

 ~~~
def __init__(self, root_dir, max_num_nbr=12, radius=8, dmin=0, step=0.2,
              random_seed=123):
~~~
   
- `model.py` : graph convolutionì— í•„ìš”í•œ ì •ë³´ë“¤ì´ pytorch íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•´ ë§Œë“¤ì–´ì ¸ ìˆë‹¤.
- `predict.py` : ì™„ì„±ëœ ëª¨ë¸ì„ ì´ìš©í•´ ë¬¼ì„±ì„ ì˜ˆì¸¡í•œë‹¤.
- `draw_graph.py` : í•™ìŠµ/ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚´ì¤€ë‹¤.

### ğŸ”· output íŒŒì¼
- `checkpoint.pth.tar` : ë§ˆì§€ë§‰ epoch ëª¨ë¸ ì €ì¥.
- `model_best.pth.tar` : í•™ìŠµ ì¤‘ ê°€ì¥ ì •í™•í•œ validation ê²°ê³¼ë¥¼ ë‚¸ ëª¨ë¸ ì €ì¥.
- `test_result.csv` : test setì— ìˆëŠ” ê° ê²°ì •ì˜ ID, target value, predicted value ì €ì¥.

### ğŸ”· ê° í´ë” ì„¤ëª…
- `data` : MPì—ì„œ ê°€ì ¸ì˜¨ train & predictë¥¼ ìœ„í•œ ë°ì´í„°ê°€ ë“¤ì–´ê°€ ìˆë‹¤.
  - `sample-classification`, `sample-regression` :
  
    Trainingê³¼ Predicting ì „ì—, CGCNNì—ê²Œ ì…ë ¥í•  ë°ì´í„°ë“¤ì„ í•˜ë‚˜ì˜ í´ë”ë¡œ ëª¨ì•„ë†“ì•„ì•¼ í•œë‹¤. 

    ëª¨ì•„ë†“ì€ ì´ input í´ë”ì—ëŠ” `id_prop.csv`, `atom_init.json`, `ID.cif` íŒŒì¼ì´ ë“¤ì–´ê°€ ìˆì–´ì•¼ í•œë‹¤.

    ìš°ë¦¬ê°€ ë‹¤ìš´ë°›ì€ ìƒ˜í”Œ ì½”ë“œ ì¤‘ì—ì„œëŠ” data í´ë” ì•ˆì— ìˆëŠ” `sample-classification` í´ë”ì™€ `sample-regression` í´ë”ê°€ ì´ input í´ë”ì— í•´ë‹¹í•œë‹¤.
    
- `node_vector_generation` : ì´ í´ë” ë‚´ì—ì„œ ì‘ì—… ì‹œ, node feature vectorë¥¼ ì¡°ì ˆí•  ìˆ˜ ìˆë‹¤.
  
   node feature vectorì— ëŒ€í•œ ì •ë³´ëŠ” `atom_init.json` íŒŒì¼ì— ì €ì¥ë˜ì–´ ìˆë‹¤.
  
   ë§Œì¼ node feature vectorë¥¼ ìˆ˜ì •í•˜ê³  ì‹¶ë‹¤ë©´, `encoding_feature_num.py` ì˜ feature setì„ ì¡°ì ˆ ì‹œ `atom_init.json` íŒŒì¼ë„ ë®ì–´ì“°ê¸° ëª¨ë“œë¡œ ìˆ˜ì •ëœë‹¤
   
- `pre-trained` : ë…¼ë¬¸ì—ì„œ ë³´ê³ ë˜ì—ˆë˜ í•™ìŠµëœ ëª¨ë¸ì— ëŒ€í•œ dataê°€ ë“¤ì–´ê°€ ìˆë‹¤.

## ğŸ“Œ ìƒ˜í”Œ ë°ì´í„° í›ˆë ¨ (txie-93 github version)

ìš°ì„  ì ì€ ë°ì´í„°ë¥¼ ê°€ì§€ê³  í›ˆë ¨í•´ë³´ê¸° ìœ„í•´, sample-regressionì´ë¼ëŠ” í´ë”ì— input ë°ì´í„°ë¥¼ ëª¨ë‘ êµ¬ì„±í•´ë†“ì•˜ë‹¤.

main.pyëŠ” 'cgcnn-master' í´ë”ì— ë“¤ì–´ìˆê¸° ë•Œë¬¸ì— ë‹¤ìŒê³¼ ê°™ì´ ì´ í´ë”ì˜ ê²½ë¡œì—ì„œ ì‹œì‘í•´ì•¼ í•œë‹¤.

~~~
(cgcnn) C:\Users\ingyeong\Desktop\Summer\cgcnn-master>
~~~

main.pyë¥¼ ì‹¤í–‰ì‹œí‚¬ ë•ŒëŠ” ë‹¤ìŒê³¼ ê°™ì´ train : validation : testì˜ ë¹„ìœ¨ê³¼, ì–´ëŠ ê²½ë¡œì— ìˆëŠ” ë°ì´í„°ë¥¼ ì‚¬ìš©í• ì§€ë¥¼ ì§€ì •í•´ì£¼ë©´ ëœë‹¤. 

~~~
python main.py --train-size 0.6 --val-size 0.2 --test-size 0.2 data/sample-regression
~~~
í˜„ì¬ ìœ„ì¹˜ëŠ” cgcnn-master í´ë”ì¸ë°, ì´ í´ë”ëŠ” cgcnn-master/data/sample-regressionì— ìˆê¸° ë•Œë¬¸ì— data/sample-regression ë¼ê³  ì ì–´ì£¼ëŠ” ê²ƒì´ë‹¤.

í›ˆë ¨ ê²°ê³¼ì— ëŒ€í•´ì„œ ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ê³  ì‹¶ë‹¤ë©´, ë‹¤ìŒ ì½”ë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ë©´ ëœë‹¤.
~~~
python draw_graph.py
~~~
ìƒì„±ëœ ê²°ê³¼ì™€ ê·¸ë˜í”„ë“¤ì€ cgcnn-master í´ë”ì— csv íŒŒì¼ê³¼ png íŒŒì¼ë¡œ ì €ì¥ë˜ì–´ ìˆì„ ê²ƒì´ë‹¤.


## ğŸ“Œ customized dataset í›ˆë ¨ (google colab version)

githubì—ì„œ ì œê³µí•œ ìƒ˜í”Œ ë°ì´í„°ì…‹ì€ í¬ê¸°ê°€ ë§¤ìš° ì‘ê¸°ë•Œë¬¸ì—, customized dataset 3ê°€ì§€ë¥¼ ì œê³µí•œë‹¤. ë°ì´í„° ìˆ˜ì§‘ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- Materials Projectì—ì„œ ì¡°ê±´ì„ is_stable=True (energy_above_hull = 0), ì‚¼ì›ê³„ ì´í•˜, ê·¸ë¦¬ê³  í¬í•¨ì›ì†Œì˜ ì›ìë²ˆí˜¸ë¥¼ Bi ì´í•˜ (noble gas ì›ì†Œ ì œì™¸) ì¡°ê±´ìœ¼ë¡œ ê²€ìƒ‰í•˜ë©´ 22,962ê°œì˜ êµ¬ì¡°-ë¬¼ì„± (formation energy, bandgap) ë°ì´í„°ë¥¼ íšë“
- ì—¬ê¸°ì„œ ëœë¤í•˜ê²Œ 1,000ê°œë¥¼ ë½‘ì•„ì„œ ì•„ë˜ì˜ ë°ì´í„°ì…‹ì„ êµ¬ì„±í•œë‹¤.
- Band gapì˜ ê²½ìš°, metal 500ê°œ, non-metal 500ê°œì„.
  
  <img width="1908" height="685" alt="download" src="https://github.com/user-attachments/assets/78714a78-efc5-4732-8a2d-8936756709e2" />
  
**Dataset #1. regression (formation energy)**

data size : 1000

Path : /data/data_regression_formE_1000/

**Dataset #2. regression (band gap)**

data size : 1000

Path : /data/data_regression_bandgap_1000/

**Dataset #3. classification (band gap)**

data size : 1000

Path : /data/data_classification_metal_1000/

í›ˆë ¨ì€ github ì½”ë“œì™€ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ì§„í–‰í•˜ë©´ ëœë‹¤.

~~~
python main.py --train-size 0.6 --val-size 0.2 --test-size 0.2 data/data_regression_formE_1000
~~~

ê·¸ë˜í”„ë¥¼ ê·¸ë¦¬ëŠ” ì½”ë“œ ë˜í•œ ë™ì¼í•˜ë‹¤.
~~~
python draw_graph.py
~~~

## ğŸ“Œ í›ˆë ¨ëœ CGCNN ëª¨ë¸ì„ ê°€ì§€ê³  ë¬¼ì„± ì˜ˆì¸¡

`pre-trained` í´ë”ì—ëŠ” ë…¼ë¬¸ì— ë‚˜ì˜¤ëŠ” í›ˆë ¨ëœ CGCNN ëª¨ë¸ì´ ë“¤ì–´ìˆë‹¤. ì´ ëª¨ë¸ì„ `predict.py`ë¡œ ì‹¤í–‰ì‹œí‚¤ë©´ ë¬¼ì„±ì„ ì˜ˆì¸¡í•  ìˆ˜ ìˆë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ `sample-regression` í´ë”ì— ìˆëŠ” ê²°ì •ì˜ formation energyë¥¼ ì˜ˆì¸¡í•˜ê³  ì‹¶ë‹¤ë©´, ë‹¤ìŒê³¼ ê°™ì´ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ ëœë‹¤.

~~~
python predict.py pre-trained/formation-energy-per-atom.pth.tar. data/sample-regression
~~~

ê²°ê³¼ ë°ì´í„°ëŠ” `test_results.csv` íŒŒì¼ë¡œ ì €ì¥ëœë‹¤.
